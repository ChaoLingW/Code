package com.hp.dao.impl;

import java.util.List;

import org.apache.commons.dbutils.DbUtils;
import org.apache.commons.dbutils.handlers.BeanHandler;
import org.apache.commons.dbutils.handlers.BeanListHandler;

import com.hp.dao.IBankDao;
import com.hp.po.Bank;
import com.hp.util.DBUtil;

public class BankDao implements IBankDao{

	@Override
	public int addBank(Bank bank) {
		
		String sql = "insert into bank (bankName,bankTel) values(?,?)";
		Object[] params ={bank.getBankName(),bank.getBankTel()};
		
		return DBUtil.update(sql, params);
	}

	@Override
	public int deleteBankByBankId(int bankId) {
		
		String sql = "delete from bank where bankId = ?";
		return DBUtil.update(sql, bankId);
	}

	@Override
	public int updateBankByBankId(Bank bank) {
		
		String sql = "update bank set bankName = ?,bankTel = ? where bankId = ? ";
		Object[] params = {bank.getBankName(),bank.getBankTel(),bank.getBankId()};
		
		return DBUtil.update(sql, params);
	}

	@Override
	public List<Bank> selectAll() {
		
		String sql = "select * from bank";
		
		return DBUtil.query(sql, new BeanListHandler<>(Bank.class), null);
	}

	@Override
	public Bank selectByBankId(int bankId) {
		
		String sql = "select * from bank where bankId = ?";
		return DBUtil.query(sql, new BeanHandler<>(Bank.class), bankId);
	}

	@Override
	public Bank selectByBankName(String bankName) {
		
		String sql = "select * from bank where bankName = ?";
		return DBUtil.query(sql, new BeanHandler<>(Bank.class), bankName);
	}

	

}
