package com.hpe.java;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.Scanner;

public class UserManage {

	static Scanner sc = new Scanner(System.in);

	public static void main(String[] args) {

		while (true) {

			System.out.println("-----------用户管理----------");
			System.out.println("1.添加\t2.删除\t3.修改\t4查询\t5.查询全部\t0.退出");
			System.out.println("请选择业务：");

			String choice = sc.nextLine();

			switch (choice) {
			case "1":
				add();
				break;

			case "2":
				delete();
				break;

			case "3":
				update();
				break;

			case "4":
				select();
				break;

			case "5":
				selectAll();
				break;

			case "0":
				System.out.println("谢谢使用");
				System.exit(0);
				break;

			default:
				System.out.println("输入有误");
				break;
			}
		}
	}

	private static void add() {
		// 显示工作
		System.out.println("请输入用户名");
		String userName = sc.nextLine();

		System.out.println("请输入密   码");
		String password = sc.nextLine();

		System.out.println("请输入真实姓名");
		String realName = sc.nextLine();

		System.out.println("请输入年   龄");
		int age = sc.nextInt();

	}

	// 像数据库中添加用户的方法
	private static addUser(String userName,String password,String realName,int age){
		
		//sql
		//insert into user(username,password,realname,age) values(?,?,?,?)
		Connection connection = getConnection();

		// 2.书写SQL语句
		String sql = "insert into user (username,password,realname,age) " + "values(?,?,?,?)";
		PreparedStatement pstmt = null;
		try {
			// 3.创建PreparedStatement对象(使用Connection创建),用于发送sql语句
			pstmt = connection.prepareStatement(sql);

			// 4.给占位符设置值
			pstmt.setString(1, username);
			pstmt.setString(2, password);
			pstmt.setString(3, realname);
			pstmt.setInt(4, age);

			// 5.发送sql,让数据库执行
			// 增删改(更新)executeUpdate()
			int row = pstmt.executeUpdate();// int 受影响的行数

			if (row > 0)
				System.out.println("添加成功");
			else
				System.out.println("添加失败");

		} catch (SQLException e) {
			e.printStackTrace();
		} finally {
			// 6.释放资源
			close(pstmt);
			close(connection);
		}
	}
	}

	private static void delete() {

	}

	private static void update() {

	}

	private static void select() {

	}

	private static void selectAll() {
		//

	}

	// 返回与数据库bigdata2的连接
	public Connection getConnection() {

		String driver = "com.mysql.jdbc.Driver";
		String user = "root";// 用户名
		String password = "mysql";// 密码
		String url = "jdbc:mysql://localhost:3306/bigdata2?useUnicode=true&characterEncoding=utf-8";// 地址

		Connection connection = null;
		try {
			Class.forName(driver);// 参数是驱动类的全类名
			connection = DriverManager.getConnection(url, user, password);
		} catch (ClassNotFoundException e) {
			e.printStackTrace();
		} catch (SQLException e) {
			e.printStackTrace();
		}

		return connection;
	}

	// 关闭Connection
	public void close(Connection connection) {

		if (connection != null)
			try {
				connection.close();
			} catch (SQLException e) {
				e.printStackTrace();
			}
	}

	// 重载
	// 关闭Statement
	public void close(Statement pstmt) {

		if (pstmt != null)
			try {
				pstmt.close();
			} catch (SQLException e) {
				e.printStackTrace();
			}
	}

	// 重载
	// 关闭ResultSet
	public void close(ResultSet resultSet) {

		if (resultSet != null)
			try {
				resultSet.close();
			} catch (SQLException e) {
				e.printStackTrace();
			}
	}

}
